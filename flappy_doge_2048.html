<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='utf-8' />
    <head>
        <title>Flappy Dog 2048</title>
    </head>

    <body style='background: black;'>
        <canvas id='canvas' width=600 height=600 style='display: block; background: #776E65; margin-left: auto; margin-right: auto;'></canvas>

        <script type='text/javascript' src='gl5.js'></script>
        <script type='text/javascript' src='behaviors.js'></script>
        <script type='text/javascript' src='conditions.js'></script>
        <script>
var BLOCKS_PER_COLUMN = 5;
var BLOCKS_PER_ROW = 2;

var doge = gl5.createImage('doge-head.png', 'doge');
doge.size = {x: 50, y: 50};
doge.pos.x = 50;
doge.friction = {x: 0, y: 0.1};
doge.inertia.x = 3;

var obstacles = [];

function makeObstacle() {
    var obstacle = [];
    var spacing = gl5.screen.size.y / BLOCKS_PER_COLUMN;
    for (var i = 0; i < BLOCKS_PER_ROW; i++) {
        obstacle.push([]);

        for (var j = 0; j < BLOCKS_PER_COLUMN; j++) {
            var tile = {};
            obstacle.push(tile);

            var block = gl5.createImage('block.png', 'block');
            block.size = {x: 100, y: 100};
            block.pos.x = i * spacing + gl5.screen.pos.x + gl5.screen.size.x / 2 + block.size.x / 2;
            block.pos.y = j * spacing + .5 * block.size.y + .5 * (spacing - block.size.y);

            var number = gl5.createText(2, 'number', block.pos);
            number.shadow = null;
            number.color = '#776E65';
            number.font = '55px Arial'

            tile.block = block;
            tile.number = number;
            obstacle[i][j] = tile;
        }
    }
}

var timer = Timer(3, doge, makeObstacle);

gl5.register(function () {
    gl5.screen.pos.x = doge.pos.x + gl5.screen.size.x / 2 - doge.size.x / 2 - 5;

    gl5.forEach(hit('doge', 'pipe'), function (b, p) {
        doge.destroy();
    });

    gl5.forEach('block', function (b) {
        if (b.pos.x < gl5.screen.pos.x - gl5.screen.size.x) {
            b.destroy();
        }
    });
});
        </script>
    </body>
</html>
